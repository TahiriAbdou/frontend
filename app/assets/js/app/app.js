var albumInfo={fetchTrackArt:function(a,b,c){$.getJSON("http://ws.audioscrobbler.com/2.0/?method=track.getInfo&api_key=4cb074e4b8ec4ee9ad3eb37d6f7eb240&artist="+c+"&track="+b+"&format=json",function(c){null!=c&&void 0!==c.track&&void 0!==c.track.album&&albumInfo.updateAlbumArt(a,c.track.album.image[3]["#text"])})},fetchAlbumArt:function(a,b,c){$.getJSON("http://ws.audioscrobbler.com/2.0/?method=album.getInfo&api_key=4cb074e4b8ec4ee9ad3eb37d6f7eb240&artist="+a+"&album="+b+"&format=json",function(a){null!=
a&&(void 0!==a.album?void 0!==a.album.image&&albumInfo.updateAlbumSort(b,a.album.image[4]["#text"],c):albumInfo.updateAlbumSort(b,"assets/img/noalbumart.png",c))})},updateAlbumSort:function(a,b,c){if(!utils.isEmpty(b)){var d=artistInfo.makeId();b='<div id={0} class="toggle-panel"> <a href="#panelAlbums"> <li> <img src="{1}" /> <h3>{2}</h3> <p>{3} songs</p> </li> </a> </div>'.format(d,b,a,c);$("#albumSortList").append(b);$(".toggle-panel a").on("click",function(a){var c=$(this).attr("href");a.preventDefault();
$(c).addClass("is-visible")});$(".cd-panel").on("click",function(a){if($(a.target).is(".cd-panel")||$(a.target).is(".cd-panel-close"))$(".cd-panel").removeClass("is-visible"),a.preventDefault()});aurousScript("#"+d).on("click",function(c){c.preventDefault();songCollection.sortByAlbum(a)})}},updateAlbumArt:function(a,b){utils.isEmpty(b)||(aurousScript("#currentAlbumArt").attr("src",b),updateDatabaseArt(b,a))}},artistInfo={fetchArtistArt:function(a,b){var c="http://ws.audioscrobbler.com/2.0/?method=artist.getInfo&api_key=4cb074e4b8ec4ee9ad3eb37d6f7eb240&artist="+
encodeURIComponent(a)+"&format=json";$.getJSON(c,function(c){null!=c&&(void 0!==c.artist?void 0!==c.artist.image&&artistInfo.updateArtistSort(a,c.artist.image[3]["#text"],b):artistInfo.updateArtistSort(a,"assets/img/noalbumart.png",b))})},makeId:function(){for(var a="",b=0;5>b;b++)a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return a},updateArtistSort:function(a,b,c){if(!utils.isEmpty(b)){var d=artistInfo.makeId();b='<div id={0} class="toggle-panel"> <a href="#panelArtists"> <li> <img src="{1}" /> <h3>{2}</h3> <p>{3} songs</p> </li> </a> </div>'.format(d,
b,a,c);$("#artistSortList").append(b);$(".toggle-panel a").on("click",function(a){var c=$(this).attr("href");a.preventDefault();$(c).addClass("is-visible")});$(".cd-panel").on("click",function(a){if($(a.target).is(".cd-panel")||$(a.target).is(".cd-panel-close"))$(".cd-panel").removeClass("is-visible"),a.preventDefault()});aurousScript("#"+d).on("click",function(c){c.preventDefault();songCollection.sortByArtist(a)})}}},songCollection={songData:"",needsUpdate:!0,artistNeedsUpdate:!0,albumNeedsUpdate:!0,
scanFilters:"",cache:null,loadAllSongs:function(){var a=songCollection.songData;if(mediaScanner.scanningActive)return alertify.error("Unable to load collection while media scan active"),alertify.success("Loaded cached db"),!1;utils.isEmpty(a)||songCollection.needsUpdate?(loadSongs(),alertify.success("Loaded fresh db")):alertify.success("Loaded cached db");return!0},populateArtist:function(a){$("#artistSortList").html("");a=atob(a);a=JSON.parse(a);for(var b=0;b<a.results.length;b++){var c=a.results[b],
d=c.artist,c=c.total,d=utils.replaceAll(decodeURIComponent(d),"+"," ");artistInfo.fetchArtistArt(d,c)}},populateAlbums:function(a){$("#albumSortList").html("");a=atob(a);a=JSON.parse(a);for(var b=0;b<a.results.length;b++){var c=a.results[b],d=c.album,e=c.artist,c=c.total,d=utils.replaceAll(decodeURIComponent(d),"+"," "),e=utils.replaceAll(decodeURIComponent(e),"+"," ");albumInfo.fetchAlbumArt(e,d,c)}},sortByArtist:function(a){if(null!=songCollection.cache){$("#artistTable").DataTable().clear();for(var b=
songCollection.cache,c=0;c<b.results.length;c++){var d=b.results[c],e=d.artist,e=utils.replaceAll(decodeURIComponent(e),"+"," ");if(e===a){var f=d.id,g=d.title,h=d.album,k=d.albumArt,l=aurousScript.player.toTime(d.duration),d=d.link;a=utils.replaceAll(decodeURIComponent(a),"+"," ");g=utils.replaceAll(decodeURIComponent(g),"+"," ");h=utils.replaceAll(decodeURIComponent(h),"+"," ");d=utils.decodeHtml(d);songCollection.appendSortedArtistRow(f,k,l,h,g,e,d);songCollection.bindSortedArtistRow(f,g,e,k,d);
aurousScript("#currentSortedArtist").html(e)}}}},sortByAlbum:function(a){if(null!=songCollection.cache){$("#albumTable").DataTable().clear();for(var b=songCollection.cache,c=0;c<b.results.length;c++){var d=b.results[c],e=d.album,e=utils.replaceAll(decodeURIComponent(e),"+"," ");if(e===a){var f=d.id,g=d.title,h=d.albumArt,k=aurousScript.player.toTime(d.duration),l=d.link,d=d.artist,d=utils.replaceAll(decodeURIComponent(d),"+"," "),g=utils.replaceAll(decodeURIComponent(g),"+"," "),l=utils.decodeHtml(l);
songCollection.appendSortedAlbum(f,h,k,e,g,d,l);songCollection.bindSortedAlbumRow(f,g,d,h,l);aurousScript("#currentSortedAlbum").html(e)}}}},appendSortedArtistRow:function(a,b,c,d,e,f,g){var h=$("#artistTable").DataTable();h.row.add(['<button class="btn btn-transparent control-show"><a href="#"><i class="material-icons">add</i></a></button> <button class="btn btn-transparent"><a href="#"><i id="artist-row-icon-{0}" class="material-icons">play_arrow</i></a></button>'.format(a),e,f,d,c]).index();h.row(a-
1).draw();aurousScript("#artist-row-icon-"+a).closest("td").addClass("result-control");c=aurousScript("#artist-row-icon-"+a).closest("tr");c.attr("artist-data-id",a);c.attr("artist-data-value",g);c.attr("artist-data-album-art",b);c.attr("artist-data-song-name",e);c.attr("artist-data-artist-name",f)},appendSortedAlbum:function(a,b,c,d,e,f,g){var h=$("#albumTable").DataTable();h.row.add(['<button class="btn btn-transparent control-show"><a href="#"><i class="material-icons">add</i></a></button> <button class="btn btn-transparent"><a href="#"><i id="album-row-icon-{0}" class="material-icons">play_arrow</i></a></button>'.format(a),
e,f,d,c]).index();h.row(a-1).draw();aurousScript("#album-row-icon-"+a).closest("td").addClass("result-control");c=aurousScript("#album-row-icon-"+a).closest("tr");c.attr("album-data-id",a);c.attr("album-data-value",g);c.attr("album-data-album-art",b);c.attr("album-data-song-name",e);c.attr("album-data-artist-name",f)},appendSortedArtistRow:function(a,b,c,d,e,f,g){var h=$("#artistTable").DataTable();h.row.add(['<button class="btn btn-transparent control-show"><a href="#"><i class="material-icons">add</i></a></button> <button class="btn btn-transparent"><a href="#"><i id="artist-row-icon-{0}" class="material-icons">play_arrow</i></a></button>'.format(a),
e,f,d,c]).index();h.row(a-1).draw();aurousScript("#artist-row-icon-"+a).closest("td").addClass("result-control");c=aurousScript("#artist-row-icon-"+a).closest("tr");c.attr("artist-data-id",a);c.attr("artist-data-value",g);c.attr("artist-data-album-art",b);c.attr("artist-data-song-name",e);c.attr("artist-data-artist-name",f)},bindSortedArtistRow:function(a,b,c,d,e){aurousScript("#artist-row-icon-"+a).on("click",function(){void 0!==window.previousCollectionRow&&(window.previousCollectionRow.removeClass("result-now-playing"),
aurousScript("#artist-row-icon-"+window.previousCollectId).html("play_arrow"));var a=aurousScript(this).closest("tr");a.addClass("result-now-playing");var e=a.attr("artist-data-id");window.currentCollectionId=e;aurousScript("#artist-row-icon-"+e).html("pause");var h=a.attr("artist-data-value");aurousScript.player.changeMedia(b,c,d,h);aurousScript("#playerPause").show();aurousScript("#playerPlay").hide();window.previousCollectionRow=a;window.previousCollectId=e})},bindSortedAlbumRow:function(a,b,c,
d,e){aurousScript("#album-row-icon-"+a).on("click",function(){void 0!==window.previousCollectionRow&&(window.previousCollectionRow.removeClass("result-now-playing"),aurousScript("#album-row-icon-"+window.previousCollectId).html("play_arrow"));var a=aurousScript(this).closest("tr");a.addClass("result-now-playing");var e=a.attr("album-data-id");window.currentCollectionId=e;aurousScript("#album-row-icon-"+e).html("pause");var h=a.attr("album-data-value");aurousScript.player.changeMedia(b,c,d,h);aurousScript("#playerPause").show();
aurousScript("#playerPlay").hide();window.previousCollectionRow=a;window.previousCollectId=e})},bindCollectionRow:function(a,b,c,d,e){aurousScript("#collection-row-icon-"+a).on("click",function(){void 0!==window.previousCollectionRow&&(window.previousCollectionRow.removeClass("result-now-playing"),aurousScript("#collection-row-icon-"+window.previousCollectId).html("play_arrow"));var a=aurousScript(this).closest("tr");a.addClass("result-now-playing");var e=a.attr("collection-data-id");window.currentCollectionId=
e;aurousScript("#collection-row-icon-"+e).html("pause");var h=a.attr("collection-data-value");aurousScript.player.changeMedia(b,c,d,h);aurousScript("#playerPause").show();aurousScript("#playerPlay").hide();window.previousCollectionRow=a;window.previousCollectId=e})},appendLocalCollection:function(a){songCollection.cache=a;$("#collectionResult").DataTable().clear();for(var b=0;b<a.results.length;b++){var c=a.results[b],d=c.id,e=c.title,f=c.artist,g=c.album,h=c.albumArt,k=aurousScript.player.toTime(c.duration),
c=c.link,f=utils.replaceAll(decodeURIComponent(f),"+"," "),e=utils.replaceAll(decodeURIComponent(e),"+"," "),g=utils.replaceAll(decodeURIComponent(g),"+"," "),c=utils.decodeHtml(c);songCollection.appendCollectionRow(d,h,k,g,e,f,c)}},removeCollectionRow:function(a){var b=$("#collectionResult").DataTable(),c=$("#collection-row-icon-"+a).closest("tr");b.row(c).remove().draw();console.log(a)},appendDynamicRow:function(a,b,c,d,e,f,g){g=utils.decodeHtml(g);c=aurousScript.player.toTime(c);var h=$("#collectionResult").DataTable();
h.row.add(['<button class="btn btn-transparent control-show"><a href="#"><i class="material-icons">add</i></a></button> <button class="btn btn-transparent"><a href="#"><i id="collection-row-icon-{0}" class="material-icons">play_arrow</i></a></button>'.format(a),e,f,d,c]).index();h.row(a-1).draw();aurousScript("#collection-row-icon-"+a).closest("td").addClass("result-control");d=aurousScript("#collection-row-icon-"+a).closest("tr");d.attr("collection-data-id",a);d.attr("collection-data-value",g);d.attr("collection-data-album-art",
b);d.attr("collection-data-song-name",e);d.attr("collection-data-artist-name",f);songCollection.bindCollectionRow(a,e,f,b,g);return!0},appendCollectionRow:function(a,b,c,d,e,f,g){g=utils.decodeHtml(g);var h=$("#collectionResult").DataTable();h.row.add(['<button class="btn btn-transparent control-show"><a href="#"><i class="material-icons">add</i></a></button> <button class="btn btn-transparent"><a href="#"><i id="collection-row-icon-{0}" class="material-icons">play_arrow</i></a></button>'.format(a),
e,f,d,c]).index();h.row(a-1).draw();aurousScript("#collection-row-icon-"+a).closest("td").addClass("result-control");c=aurousScript("#collection-row-icon-"+a).closest("tr");c.attr("collection-data-id",a);c.attr("collection-data-value",g);c.attr("collection-data-album-art",b);c.attr("collection-data-song-name",e);c.attr("collection-data-artist-name",f);songCollection.bindCollectionRow(a,e,f,b,g);return!0},collectionCallback:function(a){a=atob(a);a=JSON.parse(a);var b=songCollection.songData;utils.isEmpty(b)||
songCollection.needsUpdate?(songCollection.needsUpdate=!1,songCollection.songData=a,songCollection.appendLocalCollection(a)):songCollection.appendLocalCollection(b)},completeScanning:function(){mediaScanner.scanningActive=!1;alertify.success("Media Scanned from Disk")}},downloader={downloadSong:function(a,b,c){if("function"==typeof downloadSongAsync){var d=c.split(".").pop();a=a+"-"+b+"."+d;downloadSongAsync(c,a);console.log(a)}}},mediaScanner={scanPaths:"",scanningActive:!1,scanFilters:"",init:function(){if(mediaScanner.scanningActive)return!1;
mediaScanner.scanningActive=!0;alertify.success("Scanning media from your disk, please wait");"function"==typeof scanMedia&&scanMedia();return!0},showSize:function(a){alertify.success(a)},scannerErrorCallback:function(){mediaScanner.scanningActive=!1;songCollection.needsUpdate=!1;alertify.error("Unable to scan due to lack of paths. Please check your settings.")},completeScanning:function(){mediaScanner.scanningActive=!1;songCollection.needsUpdate=!0;alertify.success("Scanning media complete.");songCollection.loadAllSongs()}};
aurousScript(function(){aurousScript.player=document.getElementById("audioPlayer");aurousScript.player.source=document.getElementById("playersource");aurousScript.player.averageAudio=0;aurousScript.player.shuffle=!1;aurousScript.player.repeat=!1;aurousScript("#playerPlay").click(function(){aurousScript.player.alterPlayback();event.preventDefault()});aurousScript("#playerPause").click(function(){aurousScript.player.alterPlayback();event.preventDefault()});aurousScript("#playerSkipNext").click(function(){aurousScript.player.playNext();
event.preventDefault()});aurousScript("#playerSkipPrevious").click(function(){aurousScript.player.playPrevious();event.preventDefault()});aurousScript.player.getCurrentTime=function(){return aurousScript.player.currentTime};aurousScript.player.playNext=function(){switch(window.activeViewPort){case "search":aurousScript.player.playNextSearchResult();break;case "collection":aurousScript.player.playNextCollection();break;case "artist":aurousScript.player.playNextArtist();break;case "album":aurousScript.player.playNextAlbum();
break;default:text="Looking forward to the Weekend"}};aurousScript.player.playPrevious=function(){switch(window.activeViewPort){case "search":aurousScript.player.playLastSearchResult();break;case "collection":aurousScript.player.playLastCollection();break;case "artist":aurousScript.player.playLastArtist();break;case "album":aurousScript.player.playLastAlbum();break;default:text="Looking forward to the Weekend"}};aurousScript.player.getDuration=function(){return aurousScript.player.duration};aurousScript("#song-volume-slider").slider().bind({change:function(){aurousScript.player.setVolume(aurousScript("#song-volume-slider").slider("getValue")/
100)}});aurousScript("#song-progress-slider").on("slideStop",function(a){a=aurousScript.player.getDuration()*(aurousScript("#song-progress-slider").slider("getValue")/100);aurousScript.player.setTime(a)});aurousScript.player.getPlaybackPercentage=function(){return aurousScript.player.duration};aurousScript.player.onloadeddata=function(){};aurousScript.player.onreadystatechange=function(){};aurousScript.player.addEventListener("suspend",function(){});aurousScript.player.addEventListener("abort",function(){});
aurousScript.player.addEventListener("onreadystatechange",function(){});aurousScript.player.addEventListener("error",function(a){this.networkState===HTMLMediaElement.NETWORK_NO_SOURCE&&alertify.error("Error starting playback. ")},!0);aurousScript.player.addEventListener("stalled",function(){});aurousScript.player.addEventListener("timeupdate",function(){var a=aurousScript.player.getCurrentTime(),b=aurousScript.player.getDuration(),c=100*a/b;aurousScript("#song-current-time").html(aurousScript.player.toTime(a));
aurousScript("#song-total-time").html(aurousScript.player.toTime(b));aurousScript("#song-progress-slider").slider("setValue",c)});aurousScript.player.toTime=function(a){a=moment.duration(a,"seconds");var b="",c=a.hours();0<c&&(b=c+":");c=10>a.seconds()?"0"+a.seconds():a.seconds();return b=b+a.minutes()+":"+c};aurousScript.player.addEventListener("ended",function(){aurousScript.player.playNext()});aurousScript.player.playNextCollection=function(){var a=$(window.previousCollectionRow).closest("tr").next("tr");
window.previousCollectionRow.removeClass("result-now-playing");aurousScript("#collection-row-icon-"+window.previousCollectId).html("play_arrow");var b=a.closest("tr"),c=b.attr("collection-data-id");window.currentCollectionId=c;var d=a.attr("collection-data-album-art");aurousScript("#collection-row-icon-"+c).html("pause");a.addClass("result-now-playing");var e=b.attr("collection-data-value"),f=b.attr("collection-data-artist-name"),b=b.attr("collection-data-song-name");aurousScript.player.changeMedia(b,
f,d,e);aurousScript("#playerPause").show();aurousScript("#playerPlay").hide();window.previousCollectionRow=aurousScript(a);window.previousCollectId=c};aurousScript.player.playNextAlbum=function(){var a=$(window.previousCollectionRow).closest("tr").next("tr");window.previousCollectionRow.removeClass("result-now-playing");aurousScript("#album-row-icon-"+window.previousCollectId).html("play_arrow");var b=a.closest("tr"),c=b.attr("album-data-id");window.currentCollectionId=c;var d=a.attr("album-data-album-art");
aurousScript("#album-row-icon-"+c).html("pause");a.addClass("result-now-playing");var e=b.attr("album-data-value"),f=b.attr("album-data-artist-name"),b=b.attr("album-data-song-name");aurousScript.player.changeMedia(b,f,d,e);aurousScript("#playerPause").show();aurousScript("#playerPlay").hide();window.previousCollectionRow=aurousScript(a);window.previousCollectId=c};aurousScript.player.playNextArtist=function(){var a=$(window.previousCollectionRow).closest("tr").next("tr");window.previousCollectionRow.removeClass("result-now-playing");
aurousScript("#artist-row-icon-"+window.previousCollectId).html("play_arrow");var b=a.closest("tr"),c=b.attr("artist-data-id");window.currentCollectionId=c;var d=a.attr("artist-data-album-art");aurousScript("#artist-row-icon-"+c).html("pause");a.addClass("result-now-playing");var e=b.attr("artist-data-value"),f=b.attr("artist-data-artist-name"),b=b.attr("artist-data-song-name");aurousScript.player.changeMedia(b,f,d,e);aurousScript("#playerPause").show();aurousScript("#playerPlay").hide();window.previousCollectionRow=
aurousScript(a);window.previousCollectId=c};aurousScript.player.playNextSearchResult=function(){var a=$(window.previousSearchResult).closest("tr").next("tr");window.previousSearchResult.removeClass("result-now-playing");aurousScript("#row-icon-"+window.previousSearchId).html("play_arrow");var b=a.closest("tr"),c=b.attr("data-id"),d=a.attr("data-album-art");aurousScript("#row-icon-"+c).html("pause");a.addClass("result-now-playing");var e=b.attr("data-value"),f=b.attr("data-artist-name"),b=b.attr("data-song-name");
aurousScript.player.changeMedia(b,f,d,e);aurousScript("#playerPause").show();aurousScript("#playerPlay").hide();window.previousSearchResult=aurousScript(a);window.previousSearchId=c};aurousScript.player.playLastSearchResult=function(){var a=$(window.previousSearchResult).closest("tr").prev("tr");window.previousSearchResult.removeClass("result-now-playing");aurousScript("#row-icon-"+window.previousSearchId).html("play_arrow");var b=a.closest("tr"),c=b.attr("data-id");window.currentCollectionId=c;var d=
a.attr("data-album-art");aurousScript("#row-icon-"+c).html("pause");a.addClass("result-now-playing");var e=b.attr("data-value"),f=b.attr("data-artist-name"),b=b.attr("data-song-name");aurousScript.player.changeMedia(b,f,d,e);aurousScript("#playerPause").show();aurousScript("#playerPlay").hide();window.previousSearchResult=aurousScript(a);window.previousSearchId=c};aurousScript.player.playLastArtist=function(){var a=$(window.previousCollectionRow).closest("tr").prev("tr");window.previousCollectionRow.removeClass("result-now-playing");
aurousScript("#artist-row-icon-"+window.previousCollectId).html("play_arrow");var b=a.closest("tr"),c=b.attr("artist-data-id"),d=a.attr("artist-data-album-art");aurousScript("#artist-row-icon-"+c).html("pause");a.addClass("result-now-playing");var e=b.attr("artist-data-value"),f=b.attr("artist-data-artist-name"),b=b.attr("artist-data-song-name");aurousScript.player.changeMedia(b,f,d,e);aurousScript("#playerPause").show();aurousScript("#playerPlay").hide();window.previousCollectionRow=aurousScript(a);
window.previousCollectId=c};aurousScript.player.playLastAlbum=function(){var a=$(window.previousCollectionRow).closest("tr").prev("tr");window.previousCollectionRow.removeClass("result-now-playing");aurousScript("#album-row-icon-"+window.previousCollectId).html("play_arrow");var b=a.closest("tr"),c=b.attr("album-data-id"),d=a.attr("album-data-album-art");aurousScript("#album-row-icon-"+c).html("pause");a.addClass("result-now-playing");var e=b.attr("album-data-value"),f=b.attr("album-data-artist-name"),
b=b.attr("album-data-song-name");aurousScript.player.changeMedia(b,f,d,e);aurousScript("#playerPause").show();aurousScript("#playerPlay").hide();window.previousCollectionRow=aurousScript(a);window.previousCollectId=c};aurousScript.player.playLastCollection=function(){var a=$(window.previousCollectionRow).closest("tr").prev("tr");window.previousCollectionRow.removeClass("result-now-playing");aurousScript("#collection-row-icon-"+window.previousCollectId).html("play_arrow");var b=a.closest("tr"),c=b.attr("collection-data-id"),
d=a.attr("collection-data-album-art");aurousScript("#collection-row-icon-"+c).html("pause");a.addClass("result-now-playing");var e=b.attr("collection-data-value"),f=b.attr("collection-data-artist-name"),b=b.attr("collection-data-song-name");aurousScript.player.changeMedia(b,f,d,e);aurousScript("#playerPause").show();aurousScript("#playerPlay").hide();window.previousCollectionRow=aurousScript(a);window.previousCollectId=c};aurousScript.player.getVolume=function(){return aurousScript.player.volume};
aurousScript.player.setVolume=function(a){aurousScript.player.volume=a};aurousScript.player.toggleAutoPlay=function(){0==player.autoplay?!0:!1};aurousScript.player.setTime=function(a){aurousScript.player.currentTime=a};aurousScript.player.alterPlayback=function(){1==aurousScript.player.paused?(aurousScript.player.play(),aurousScript("#playerPause").show(),aurousScript("#playerPlay").hide()):(aurousScript.player.pause(),aurousScript("#playerPause").hide(),aurousScript("#playerPlay").show())};aurousScript.player.reloadMedia=
function(){aurousScript.player.load()};aurousScript.player.changeMedia=function(a,b,c,d){aurousScript.player.pause();aurousScript.player.currentTime=0;aurousScript.player.source.src=d;aurousScript.player.load();aurousScript.player.play();aurousScript("#currentAlbumArt").attr("src",c);aurousScript("#currentTitle").html(a);aurousScript("#currentArtist").html(b);aurousScript("#playerPause").show();aurousScript("#playerPlay").hide();"collection"!=window.activeViewPort&&"artist"!=window.activeViewPort&&
"album"!=window.activeViewPort||"assets/img/noalbumart.png"!=c||albumInfo.fetchTrackArt(window.currentCollectionId,a,b)};aurousScript.player.getPlayerData=function(){return aurousScript.player.averageAudio};aurousScript.player.getAverageVolume=function(a){for(var b=0,c=a.length,d=0;d<c;d++)b+=a[d];return b/c};aurousScript.player.context=new webkitAudioContext;aurousScript.player.analyser=aurousScript.player.context.createAnalyser();aurousScript.player.contextSource=aurousScript.player.context.createMediaElementSource(aurousScript.player);
aurousScript.player.contextSource.connect(aurousScript.player.analyser);aurousScript.player.analyser.connect(aurousScript.player.context.destination);aurousScript.player.frequencyData=new Uint8Array(aurousScript.player.analyser.frequencyBinCount);aurousScript.player.renderFrame=function(){requestAnimationFrame(aurousScript.player.renderFrame);aurousScript.player.analyser.getByteFrequencyData(aurousScript.player.frequencyData);aurousScript.player.averageAudio=aurousScript.player.getAverageVolume(aurousScript.player.frequencyData)};
aurousScript.player.getFrequencyData=function(){return aurousScript.player.frequencyData};aurousScript.player.renderFrame();window.player=aurousScript.player});
var playlist={scanPaths:"",scanningActive:!1,scanFilters:"",addToPlaylist:function(){mediaScanner.scanningActive=!0;scanMedia()},completeScanning:function(){mediaScanner.scanningActive=!1;alertify.success("Media Scanned from Disk")}},AUROUS_PLUGINS=[["hello",1,"Andrews Hello Script","Andrew","This plugin should list all plugins currently found on the system.","https://github.com/Codeusa/","https://twitter.com/andrewmd5",!1],["gohan",2.4,"Andrews Gohan Script","Andrew","Draws a picture of Gohan on the screen",
"https://github.com/codeusa/","https://twitter.com/andrewmd5",!1]];window.activePlugins={};window.as=$;window.aurousScript=$;function search(a){coreSearch(a);aurousScript("#discoverIntro").remove();aurousScript("#alertError").hide();aurousScript("#loading").show();aurousScript("#search-result").hide();aurousScript("#search-results-count").hide()}
function buildSearchResult(a,b,c,d,e,f,g){return'<tr data-id="{0}" data-value="{1}" data-album-art="{9}" data-song-name="{3}" data-artist-name="{4}"><td class="result-control"> <button class="btn btn-transparent control-show"><a href="#"><i class="material-icons" id="control-show-{10}">add</i></a></button> <a href="#"> <button class="btn btn-transparent"><a href="#"><i id="row-icon-{2}" class="material-icons">play_arrow</i></a></button></td> <td>{5}</td> <td>{6}</td> <td>{7}</td> <td>{8}</td> </tr>'.format(a,g,
a,e,f,e,f,d,c,b,a)}function handleException(a){aurousScript("#loading").hide();aurousScript("#search-result").hide();aurousScript("#search-results-count").hide();aurousScript("#alertError").html('No result found for <strong><span id="searchQuery">'+a+"</span></strong>. Please check your spelling or try fewer keywords.");aurousScript("#alertError").show()}function millisToMinutesAndSeconds(a){var b=Math.floor(a/6E4);a=(a%6E4/1E3).toFixed(0);return b+":"+(10>a?"0":"")+a}
function lookupRemote(a,b){if(null===b)return handleException("Error encountered"),!1;var c=b.artist,d=b.title,c=utils.replaceAll(decodeURIComponent(c),"+"," "),d=utils.replaceAll(decodeURIComponent(d),"+"," ");b.artist=c;b.title=d;var e=null;$.getJSON("http://ws.audioscrobbler.com/2.0/?method=track.getInfo&api_key=4cb074e4b8ec4ee9ad3eb37d6f7eb240&artist="+c+"&track="+d+"&format=json",function(c){null!=c&&(e=c);appendResults(a,b,e)})}
function bindData(a,b,c,d,e){aurousScript("#row-icon-"+a).on("click",function(){void 0!==window.previousSearchResult&&(window.previousSearchResult.removeClass("result-now-playing"),aurousScript("#row-icon-"+window.previousSearchId).html("play_arrow"));var a=aurousScript(this).closest("tr");a.addClass("result-now-playing");var e=a.attr("data-id");aurousScript("#row-icon-"+e).html("pause");var h=a.attr("data-value");aurousScript.player.changeMedia(b,c,d,h);aurousScript("#playerPause").show();aurousScript("#playerPlay").hide();
window.previousSearchResult=a;window.previousSearchId=e})}function bindDownload(a,b,c,d){aurousScript("#control-show-"+a).on("click",function(){console.log(a);downloader.downloadSong(b,c,d)})}
function appendResults(a,b,c){if(void 0!==c.track){var d=b.duration,e="Unknown",f="assets/img/noalbumart.png";void 0!==c.track&&(d=millisToMinutesAndSeconds(c.track.duration));void 0!==c.track.album&&(e=c.track.album.title);void 0!==c.track.album&&(f=c.track.album.image[3]["#text"]);f.length||(f="assets/img/noalbumart.png");c=buildSearchResult(a,f,d,e,b.title,b.artist,b.link);aurousScript("#searchResultsTable tbody").append(c);bindData(a,b.title,b.artist,f,b.link)}else f=buildSearchResult(a,"assets/img/noalbumart.png",
b.duration,b.album,b.title,b.artist,b.link),aurousScript("#searchResultsTable tbody").append(f),bindData(a,b.title,b.artist,"assets/img/noalbumart.png",b.link);bindDownload(a,b.title,b.artist,b.link)}
function searchCallback(a){a=atob(a);a=JSON.parse(a);if(0==a.results.length)return handleException(a.phrase),!1;var b="{0} results from the Aurous Network".format(a.results.length);aurousScript("#searchResultsTable tbody").html("");aurousScript("#search-results-count").text(b);for(b=0;b<a.results.length;b++)lookupRemote(b,a.results[b]);aurousScript("#loading").hide();aurousScript("#search-result").show();aurousScript("#search-results-count").show();window.activeViewPort="search"}
var settings={pathSelector:$("#scanPathSelector"),currentPath:"",hasVKAuth:!1,previousSelectEngine:"",selectedSearchEngine:"",bind:function(){settings.pathSelector.on("change",function(){settings.currentPath=this.value});$("#removeFolder").click(function(){settings.removeScanPath()});$("#saveSettings").click(function(){settings.save();loadSettings()});$("#vkAuthButton").click(function(a){settings.handleVKAuth();a.preventDefault()});$("#selectAvatar").click(function(a){"function"==typeof selectProfilePicture&&
selectProfilePicture();a.preventDefault()});$(".selectSearchEngine").on("focus",function(){previousSelectEngine=this.value}).change(function(){if("VK"===this.value&&!settings.hasVKAuth)return $(".selectSearchEngine").val(settings.previousSelectEngine).change(),alertify.error("You cannot use VK until you authorize your account."),!1;settings.previousSelectEngine=this.value});loadSettings();checkAuths();return!0},load:function(a){a=atob(a);a=JSON.parse(a);settings.setDisplayName(a.displayName);settings.setAvatar(a.avatarPath);
settings.setScanPaths(a.scanPaths);settings.setRestrictions(a.scanRestrictions);settings.setExcludes(a.scanExcludes);return!0},handleVKAuth:function(){"Deauthorize"===$("#vkAuthButton").html()?"function"==typeof deleteVK&&deleteVK():"function"==typeof authVK&&authVK()},setAuthButtons:function(a){1==a?($("#vkAuthButton").removeClass("btn-success"),$("#vkAuthButton").addClass("btn-danger"),$("#vkAuthButton").html("Deauthorize"),settings.hasVKAuth=!0):($("#vkAuthButton").addClass("btn-success"),$("#vkAuthButton").removeClass("btn-danger"),
$("#vkAuthButton").html("Authorize"),settings.hasVKAuth=!1)},save:function(){var a=settings.getExcludes(),b=settings.getRestrictions(),c=settings.getAllScanPaths(),d=settings.getDefaultSearchEngine(),e=settings.getUsername(),f=settings.getAvatar();saveSettings(a,b,c,d,e,f);alertify.success("Settings Saved.")},getAllScanPaths:function(){var a="";$("#scanPathSelector option").each(function(){0<a.length&&(a+=",");var b=$(this).text(),b='"'+b.replace(/\s+/,"")+'"';a+=b});return a},getExcludes:function(){return $("#inputFileTypeExclude").val()},
getRestrictions:function(){return $("#inputFileTypeRestrict").val()},getUsername:function(){return $("#inputDisplayName").val()},getAvatar:function(){return $("#settingsAvatar").attr("src")},getDefaultSearchEngine:function(){return $(".selectSearchEngine").val()},setDefaultSearchEngine:function(a){},setAvatar:function(a){$("#settingsAvatar").attr("src",a);$("#sideBarAvatar").attr("src",a)},setDisplayName:function(a){$("#inputDisplayName").val(a);$(".nav-username").html(a)},setRestrictions:function(a){0<
a.length?(a=a.toString().replace(",",";"),$("#inputFileTypeRestrict").val(a)):$("#inputFileTypeRestrict").val("")},setExcludes:function(a){0<a.length?(a=a.toString().replace(",",";"),$("#inputFileTypeRestrict").val(a)):$("#inputFileTypeRestrict").val("")},setScanPaths:function(a){settings.pathSelector.empty();$.each(a,function(a,c){settings.pathSelector.append(new Option(c,c))})},addScanPath:function(a){settings.pathSelector.append(new Option(a,a));songCollection.needsUpdate=!0;songCollection.albumNeedsUpdate=
!0;songCollection.artistNeedsUpdate=!0},removeScanPath:function(){$("#scanPathSelector option").each(function(){$(this).val()==settings.currentPath&&(console.log(settings.currentPath),$(this).remove())})},openSettingsMenu:function(){jQuery("#modalSettings").modal("show").on("hide.bs.modal",function(a){})}};
$(document).ready(function(){function a(){var a=$(window).height(),b=$("#player").height()+101;$(".viewport").height(a-120);$(".nav-sidebar").css("height","100%").css("height","-="+b+"px")}$.ajaxSetup({cache:!0});alertify.success("Connected to the Aurous Network");$("a").on("dragstart",function(a){a.preventDefault()});$("#minimize-app").on("click",function(a){minimize();a.preventDefault()});$("#maximize-app").on("click",function(a){maximize();a.preventDefault()});$("#close-app").on("click",function(a){close();
a.preventDefault()});$("#close-app").on("click",function(a){close();a.preventDefault()});$("#search-form").submit(function(a){var b=$("#searchbar").val();search(b);a.preventDefault()});$("#btn-search").on("click",function(a){var b=$("#searchbar").val();search(b);a.preventDefault()});$("#collectionResult").DataTable({paging:!1,oLanguage:{asStripeClasses:[""],scrollY:200,deferRender:!0,scroller:!0,sSearch:"Filter: ",sEmptyTable:'Your collection is empty. Click <a onclick="settings.openSettingsMenu();" href="javascript:void(0);">here</a> to configure your settings.'},
columns:[{width:"25px"},null,null,null,{width:"25px"}]});$("#albumTable").DataTable({paging:!1,oLanguage:{asStripeClasses:[""],scrollY:200,deferRender:!0,scroller:!0,sSearch:"Filter: ",sEmptyTable:'Your collection is empty. Click <a onclick="settings.openSettingsMenu();" href="javascript:void(0);">here</a> to configure your settings.'},columns:[{width:"25px"},null,null,null,{width:"25px"}]});$("#artistTable").DataTable({paging:!1,oLanguage:{asStripeClasses:[""],scrollY:200,deferRender:!0,scroller:!0,
sSearch:"Filter: ",sEmptyTable:'Your collection is empty. Click <a onclick="settings.openSettingsMenu();" href="javascript:void(0);">here</a> to configure your settings.'},columns:[{width:"25px"},null,null,null,{width:"25px"}]});$(".dataTables_filter input").addClass("form-control");$("#song-volume-slider").slider({formatter:function(a){return a}});$("#song-progress-slider").slider({formatter:function(a){return a},slide:function(a,b){var e=aurousScript.player.getDuration()*(b.value/100);aurousScript.player.setTime(e)}});
$(document).ready(a);$(window).resize(a);$("#nav-discover").click(function(a){$("#collection").fadeOut(100);$("#playlist").fadeOut(100);$("#nav-collection").removeClass("active");$(".playlist-study a").removeClass("active");$(this).addClass("active");$("#discover").fadeIn(100);a.preventDefault()});$("#nav-collection").click(function(a){window.activeViewPort="collection";$("#discover").fadeOut(100);$("#playlist").fadeOut(100);$("#nav-discover").removeClass("active");$(".playlist-study a").removeClass("active");
$(this).addClass("active");$("#collection").fadeIn(100);a.preventDefault()});$(".playlist-study").click(function(a){$("#discover").fadeOut(100);$("#collection").fadeOut(100);$("#nav-discover").removeClass("active");$("#nav-collection").removeClass("active");$(this).find("a").addClass("active");$("#playlist").fadeIn(100);a.preventDefault()});$("#collectionNavArtists").click(function(a){"function"==typeof sortArtistDb&&(songCollection.needsUpdate||songCollection.artistNeedsUpdate)&&(songCollection.artistNeedsUpdate=
!1,sortArtistDb());window.activeViewPort="artist";$("#collectionSongs").fadeOut(100);$("#collectionAlbums").fadeOut(100);$("#collectionNavSongs").removeClass("active");$("#collectionNavAlbums").removeClass("active");$(this).addClass("active");$("#collectionArtists").fadeIn(100);a.preventDefault()});$("#collectionNavAlbums").click(function(a){"function"==typeof sortAlbumDb&&(songCollection.needsUpdate||songCollection.albumNeedsUpdate)&&(songCollection.albumNeedsUpdate=!1,sortAlbumDb());window.activeViewPort=
"album";$("#collectionSongs").fadeOut(100);console.log("#collectionSongs faded out");$("#collectionArtists").fadeOut(100);$("#collectionNavSongs").removeClass("active");$("#collectionNavArtists").removeClass("active");$(this).addClass("active");$("#collectionAlbums").fadeIn(100);a.preventDefault()});$("#collectionNavSongs").click(function(a){window.activeViewPort="collection";$("#collectionAlbums").fadeOut(100);$("#collectionArtists").fadeOut(100);$("#collectionNavAlbums").removeClass("active");$("#collectionNavArtists").removeClass("active");
$(this).addClass("active");$("#collectionSongs").fadeIn(100);a.preventDefault()});$("#nav-discover").hasClass("active")&&($(".viewport").addClass("discover"),$(".viewport").removeClass("collection"),window.activeViewPort="discover");aurousScript("#searchResultsTable").on("dblclick","tr",function(a){a.preventDefault();void 0!==window.previousSearchResult&&(aurousScript(window.previousSearchResult).removeClass("result-now-playing"),aurousScript("#row-icon-"+window.previousSearchId).html("play_arrow"));
a=aurousScript(this).attr("data-id");var b=aurousScript(this).attr("data-album-art");aurousScript("#row-icon-"+a).html("pause");aurousScript(this).addClass("result-now-playing");var e=aurousScript(this).attr("data-value"),f=aurousScript(this).attr("data-artist-name"),g=aurousScript(this).attr("data-song-name");aurousScript.player.changeMedia(g,f,b,e);aurousScript("#playerPause").show();aurousScript("#playerPlay").hide();window.previousSearchResult=aurousScript(this);window.previousSearchId=a});aurousScript("#collectionResult").on("dblclick",
"tr",function(a){if("header"==aurousScript(this).attr("data-role"))return!1;a.preventDefault();void 0!==window.previousCollectionRow&&(window.previousCollectionRow.removeClass("result-now-playing"),aurousScript("#collection-row-icon-"+window.previousCollectId).html("play_arrow"));a=aurousScript(this).attr("collection-data-id");window.currentCollectionId=a;var b=aurousScript(this).attr("collection-data-album-art");aurousScript("#collection-row-icon-"+a).html("pause");aurousScript(this).addClass("result-now-playing");
var e=aurousScript(this).attr("collection-data-value"),f=aurousScript(this).attr("collection-data-artist-name"),g=aurousScript(this).attr("collection-data-song-name");aurousScript.player.changeMedia(g,f,b,e);aurousScript("#playerPause").show();aurousScript("#playerPlay").hide();window.previousCollectionRow=aurousScript(this);window.previousCollectId=a});aurousScript("#artistTable").on("dblclick","tr",function(a){if("header"==aurousScript(this).attr("data-role"))return!1;a.preventDefault();void 0!==
window.previousCollectionRow&&(window.previousCollectionRow.removeClass("result-now-playing"),aurousScript("#artist-row-icon-"+window.previousCollectId).html("play_arrow"));a=aurousScript(this).attr("artistTable-data-id");window.currentCollectionId=a;var b=aurousScript(this).attr("artist-data-album-art");aurousScript("#artist-row-icon-"+a).html("pause");aurousScript(this).addClass("result-now-playing");var e=aurousScript(this).attr("artist-data-value"),f=aurousScript(this).attr("artist-data-artist-name"),
g=aurousScript(this).attr("artist-data-song-name");aurousScript.player.changeMedia(g,f,b,e);aurousScript("#playerPause").show();aurousScript("#playerPlay").hide();window.previousCollectionRow=aurousScript(this);window.previousCollectId=a});aurousScript("#topSongsTable").on("dblclick","tr",function(a){a.preventDefault();void 0!==window.previousDiscovery&&(aurousScript(window.previousDiscovery).removeClass("result-now-playing"),aurousScript("#discover-row-icon-"+window.previousDiscoveyId).html("play_arrow"));
a=aurousScript(this).attr("data-id");var b=aurousScript(this).attr("data-value"),e=aurousScript(this).attr("data-artist-name"),f=aurousScript(this).attr("data-song-name"),g=aurousScript(this).attr("data-album-art");aurousScript("#discover-row-icon-"+a).html("pause");aurousScript(this).addClass("result-now-playing");aurousScript.player.changeMedia(f,e,g,b);aurousScript("#playerPause").show();aurousScript("#playerPlay").hide();window.previousDiscovery=aurousScript(this);window.previousDiscoveyId=a});
for(var b=0;6>b;b++)aurousScript("#discover-row-icon-"+b).on("click",function(){void 0!==window.previousDiscovery&&(aurousScript(window.previousDiscovery).removeClass("result-now-playing"),aurousScript("#discover-row-icon-"+window.previousDiscoveyId).html("play_arrow"));var a=aurousScript(this).closest("tr"),b=a.attr("data-id"),e=a.attr("data-value"),f=a.attr("data-artist-name"),g=a.attr("data-song-name"),h=a.attr("data-album-art");a.addClass("result-now-playing");aurousScript("#discover-row-icon-"+
b).html("pause");aurousScript.player.changeMedia(g,f,h,e);aurousScript("#playerPause").show();aurousScript("#playerPlay").hide();window.previousDiscovery=a;window.previousDiscoveyId=b});$(".dropdown").on("show.bs.dropdown",function(a){a=$(this).find(".dropdown-menu");var b=parseInt(a.css("margin-top"));a.css({"margin-top":b+5+"px",opacity:0}).animate({"margin-top":b+"px",opacity:1},150,function(){$(this).css({"margin-top":""})})});$(".dropdown").on("hide.bs.dropdown",function(a){a=$(this).find(".dropdown-menu");
var b=parseInt(a.css("margin-top"));a.css({"margin-top":b+"px",opacity:1,display:"block"}).animate({"margin-top":b+5+"px",opacity:0},150,function(){$(this).css({"margin-top":"",display:""})})});(function(a,b){a.fn.contextMenu=function(e){function f(f,h,k){var l=a(b)[h]();k=a(b)[k]();h=a(e.menuSelector)[h]();k=f+k;f+h>l&&h<f&&(k-=h);return k}return this.each(function(){a(this).on("contextmenu",function(b){if(!b.ctrlKey){var d=a(e.menuSelector).data("invokedOn",a(b.target)).show().css({position:"absolute",
left:f(b.clientX,"width","scrollLeft"),top:f(b.clientY,"height","scrollTop")}).off("click").on("click","a",function(b){d.hide();var f=d.data("invokedOn");b=a(b.target);e.menuSelected.call(this,f,b)});return!1}});a(document).click(function(){a(e.menuSelector).hide()})})}})(jQuery,window);$("#collectionResult td").contextMenu({menuSelector:"#collectionResultMenu",menuSelected:function(a,b){var e="You selected the menu item '"+b.text()+"' on the value '"+a.text()+"'";console.log(e)}});$(".toggle-panel a").on("click",
function(a){var b=$(this).attr("href");a.preventDefault();$(b).addClass("is-visible")});$(".cd-panel").on("click",function(a){if($(a.target).is(".cd-panel")||$(a.target).is(".cd-panel-close i"))$(".cd-panel").removeClass("is-visible"),a.preventDefault()});$("tbody tr").hover(function(){$(this).find(".control-show").css({opacity:1})},function(){$(this).find(".control-show").css({opacity:0})});$(".selectSearchEngine").selectpicker();mediaScanner.init();$("#nav-discover").click();"function"==typeof loadSettings&&
settings.bind();versionChecker.checkForUpdate()});String.prototype.format=function(){var a=this,b;for(b in arguments)a=a.replace("{"+b+"}",arguments[b]);return a};
var utils={isEmpty:function(a){return!a||0===a.length},escapeRegExp:function(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},decodeHtml:function(a){return $("<div/>").html(a).text()},scaleSize:function(a,b,c,d){var e=d/c;c>=a&&1>=e?(c=a,d=c*e):d>=b&&(d=b,c=d/e);return[c,d]},getImageMetaData:function(a){$("<img/>").attr("src",a).load(function(){var a=[];void 0!==this.width?(a.width=this.width,a.height=this.height):(a.width=139,a.height=139);return a})},replaceAll:function(a,b,c){return a.replace(new RegExp(utils.escapeRegExp(b),
"g"),c)}},versionChecker={version:.1,api:"https://aurous.me/api/version/",checkForUpdate:function(){$.getJSON(versionChecker.api,function(a){null!=a&&(versionChecker.version<a.version?alertify.confirm("A new version of Aurous is available.",function(b){b&&"function"==typeof openUrl&&openUrl(a.moreInfo)}):console.log("up-to-date"))})}};